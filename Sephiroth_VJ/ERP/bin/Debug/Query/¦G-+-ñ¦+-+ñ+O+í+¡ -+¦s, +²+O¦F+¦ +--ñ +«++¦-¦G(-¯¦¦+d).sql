SELECT A.FACTORY, A.STYLE_CD, A.STYLE_NAME, A.YIELD_STATUS,
       B.OBS_TYPE, MAX(B.OBS_ID) AS OBS_ID, MAX(PLAN_STRYMD) AS PLAN_STYYMD  
  FROM (
        SELECT FACTORY, STYLE_CD, 
               PKG_SBC_COMMON.FN_GET_STYLE_NAME(STYLE_CD) AS  STYLE_NAME,
               PKG_SBM_READY.FN_GET_YIELD_STATUS(FACTORY, STYLE_CD) AS YIELD_STATUS 
          FROM SBC_YIELD_INFO  
         WHERE ITEM_CD     =  [1;Item 코드;T] 
           AND SPEC_CD     LIKE  TRIM([2;Spec 코드;T]) || '%'
           AND COLOR_CD    LIKE  TRIM([3;Color 코드;T]) || '%'
         GROUP BY FACTORY, STYLE_CD ) A, SPO_LOT B
 WHERE A.FACTORY = B.FACTORY
   AND A.STYLE_CD = B.STYLE_CD   
 GROUP BY A.FACTORY, A.STYLE_CD, A.STYLE_NAME, A.YIELD_STATUS, B.OBS_TYPE
 ORDER BY A.FACTORY, A.STYLE_CD, A.STYLE_NAME, A.YIELD_STATUS, B.OBS_TYPE
 